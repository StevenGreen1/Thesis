\chapter{Particle Flow Calorimetry for Future Linear Colliders}
\label{chap:pflowandlcdetectors}

\chapterquote{I am fond of pigs.  Dogs look up to us.  Cats look down on us.  Pigs treat us as equals.}
{Winston Churchill}

%========================================================================================
%========================================================================================

Particle flow calorimetry can provide extremely good jet energy resolutions for at a future linear collider.  Jet energy resolution is crucial at the linear collider as many of the interesting processes will be characterised by multi-jet final states.  Many of these multi-jet final states will be produced from the hadronic decays of W and Z bosons and one of the key goals of the future linear collider is to be able to separate these decays.  Separation of these decays can be achieved, however, only by placing a tight requirement on the jet energy resolution; $\sigma_{E}/E \lessapprox 3.5\%$ for 50-500~GeV jets at the ILC and up to 1.5~TeV at CLIC \cite{arXiv:0907.3577}.  The use of particle flow calorimetry will also be highly beneficial for quantifying final states of interest that involving charged leptons and missing momentum.  

%========================================================================================
%========================================================================================

\section{Particle Flow Calorimetry}
The premise of particle flow calorimetry is to use the sub-detector that offers the best energy resolution to measure the energy of any given particle, which corresponds to energy measurements being made in the ECal for $\gamma$s, the HCal for neutral hadrons and, crucially, the tracker for charged particles.  The starkest contrast of this approach to that of traditional calorimetry occurs in the measurement of the energy of charged particles.  In particle flow calorimetry the energy of a charged particle is measured using the curvature of the path it transverses as it bends in a magnetic field, while in traditional calorimetry the energy would be measured using the calorimeters, predominantly the hadronic calorimeter (HCal).  The tracker energy resolution for a single charged particle of energy $E_{X^{\pm}}$ is $\sim 10^{-4} \times E_{X^{\pm}}^{2}$, while for the HCal it is $\sim 0.55 \times \sqrt{E_{X^{\pm}}}$ \cite{arXiv:0907.3577}.  The energy resolution offered by the tracker is significantly better than that offered by the HCal for energies up to $\sim \mathcal{O}(300 \text{ GeV})$.  This means that particle flow calorimetry has the potential to offer a much better energy resolution for charged particles, below $\sim \mathcal{O}(300 \text{ GeV})$, than that of the traditional calorimetry approach.  Particle flow calorimetry offers gains in performance for collision energies well beyond 300 GeV as the average long-lived particle energy for physics processes of interest is typically much less than 300 GeV.  Furthermore, it also leads to a significant improvement in the measurement of jet energies as, after the decay of short-lived particles, approximately 60\% of the energy of a jet is carried in the form of charged particles.  The measurement of jet energies in the particle flow paradigm is summarised in table \ref{table:pflowjet}.  The benefits to the energy resolution, for both charged particles and jets, offered by the particle flow approach to calorimetry is the driving factor behind why it is planned for used at the linear collider experiment.  

\begin{table}[h!]
\centering
\begin{tabular}{ l l l l l}
\hline
Jet  & Detector & Energy & Energy\\
Component &  & Fraction & Resolution\\
\hline
Charged Particles ($X^{\pm}$) & Tracker & $\sim 0.6 E_{j}$ & $10^{-4} \times E_{X^{\pm}}^{2}$ \\
Photons ($\gamma$) & ECal & $\sim 0.3 E_{j}$ & $0.15 \times \sqrt{E_{\gamma}}$ \\
Neutral Hadrons ($X^{0}$) & HCal &$\sim 0.1 E_{j}$ & $0.55 \times \sqrt{E_{X^{0}}}$ \\
\hline
\end{tabular}
\caption[The approximate jet fractions and energy resolutions for charged particles ($X^{\pm}$) of energy $E_{X^{\pm}}$, photons ($\gamma$) of energy $E_{\gamma}$ and neutral hadrons ($X^{0}$) of energy $E_{X^{0}}$.  Taken from \cite{arXiv:0907.3577}.]{The approximate jet fractions and energy resolutions for charged particles ($X^{\pm}$) of energy $E_{X^{\pm}}$, photons ($\gamma$) of energy $E_{\gamma}$ and neutral hadrons ($X^{0}$) of energy $E_{X^{0}}$.  Taken from \cite{arXiv:0907.3577}.}
\label{table:pflowjet}
\end{table}

Particle flow calorimetry is challenging to put into practice as it requires a precise reconstruction for all long-lived particles within a detector.  Charged particle energy measurements are made using the curvature of the track they transverse as they bend in the magnetic field, but they also produce calorimetric energy deposits, as shown in figure \ref{fig:particleflowpic}.  If both energy measurements are included, the energy of the charged particle will be double counted.  To avoid this, any calorimetric energy deposits associated to charged particle tracks must not be used when reporting the reconstructed energy.  Furthermore, if the calorimetric energy deposits for a neutral particle are incorrectly associated to a track, the energy measurement for that neutral particle will be totally omitted.  The combination of this double counting of charged particle energies and loss of neutral particle energies degrades the energy resolution.  This is referred to as the 'confusion' contribution to the jet energy resolution.  Particle flow calorimetry hinges on the event reconstruction being able to correctly associate all charged particle tracks to their corresponding calorimetric energy deposits.  This can only be realised using calorimeters with fine segmentation so that it is possible to resolve individual particle showers.  It also required sophisticated pattern recognition algorithms to reduce the effects of confusion.

\begin{figure}[h!]
\centering
\includegraphics[width=0.5\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/PFlow.png}
\caption[A typical simulated 250 GeV jet in the CLIC\_ILD detector, with labels identifying constituent particles.  Image taken from  \cite{arXiv:1209.4039}.]{A typical simulated 250 GeV jet in the CLIC\_ILD detector, with labels identifying constituent particles.  Image taken from  \cite{arXiv:1209.4039}.}
\label{fig:particleflowpic}
\end{figure} 

%========================================================================================
%========================================================================================

\section{International Large Detector}
\label{sec:ild}
The current detector concepts for the linear collider experiments have been designed to make particle flow calorimetry possible.  While there are a number of different concepts that are under consideration for both the ILC and CLIC one of the most prominent, and the focus of this work, is the International Large Detector (ILD).  The ILD detector, shown in figure \ref{fig:ild}, achieves very high spatial resolution for all sub-detector systems thanks to its highly segmented calorimeters and central tracking system, both of which are encompassed within a 3.5 T magnetic field.  The sophisticated pattern recognition software that is needed for particle flow calorimetry is provided by PandoraPFA \cite{arXiv:1209.4039, arXiv:0907.3577}.   

\begin{figure}[h!]
\centering
\subfloat[]{\label{fig:ild1}\includegraphics[width=0.5\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/ILD.jpg}}
\subfloat[]{\label{fig:ild2}\includegraphics[width=0.5\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/ILD_2.jpg}}
\caption[\protect\subref{fig:ild1} Quadrant view of the ILD detector concept.  The interaction point is in the lower right corner of the picture.  Dimensions are in~mm.  \protect\subref{fig:ild2} An artistic view of the ILD detector concept.  Figures taken from  \cite{Behnke:2013lya}.]{\protect\subref{fig:ild1} Quadrant view of the ILD detector concept.  The interaction point is in the lower right corner of the picture.  Dimensions are in~mm.  \protect\subref{fig:ild2} An artistic view of the ILD detector concept.  Figures taken from  \cite{Behnke:2013lya}.}
\label{fig:ild}
\end{figure} 

%========================================================================================

\subsection{Overview}
FILL THIS GAP

% Tracking overview 
The tracking system for the ILD detector consists of a multi-layer pixel-vertex detector, which is surrounded by a system of silicon strip and pixel detectors.  These are designed to give precise information about displaced vertices with respect to the impact point, which are crucial for the study of short lived particles such as the \PD or \PB mesons.  Outside of the vertex detector is the central tracker.  In ILD this is a Time Projection Chamber (TPC).  The TPC samples each charged particle track at many points giving detailed spatial information that can be used to extract the curvature of the track and hence the momentum of the charged particle that transversed it.  Finally, a further silicon strip detector surrounds the TPC to give additional, high precision, space points to aid track fitting. 

%========================================================================================

\subsection{Vertex Detector}
The main goal of the ILD vertex detector is to achieve a resolution on the impact parameter of charged particle tracks of:
\begin{equation}
\sigma_{b} < 5 \oplus \frac{10}{p\text{sin}(\theta)^{3/2}} \text{ {\mu}m,}
\end{equation}
\noindent where $\sigma_{b}$ is the resolution on the track impact parameter, $p$ is the momentum of the track and $\theta$ is the angle between the track and the vertex detector plane.  The first term in this parameterisation is the transverse impact parameters resolution and the second is a multiple-scattering term.  This makes precisely tagging secondary vertices from charm and bottom mesons possible.  Typically these mesons have relatively short proper lifetimes, $\tau$, such that $c\tau \approx \mathcal{O}(300 \text{{ \mu}m})$.  To achieve this impact parameter resolution, a spatial resolution of better than 3~{\mu}m is required near the impact point (IP).  Furthermore, a low material budget of less than 0.15~\% of a radiation length per layer is required to ensure that few electromagnetic showers are initiated within the vertex detector.  A low pixel occupancy is essential for determining the trajectory of individual tracks in the detector.  Furthermore, consideration will have to be given to the mechanical structure of the detector, power consumption and cooling.  

There are a number of different pixel technology options under consideration for the vertex detector for the ILD detector.  This is an active area of ongoing research and development for the linear collider collaboration.  The current design of the vertex detector consists of three concentric layers of double-sided ladders with the first layer contains 10 ladders, the second 11 ladders and the third 17 ladders as shown in figure \ref{fig:vertexpicture}.  Each ladder has two pixel sensors on each side and the ladder thickness is approximately 2~mm.  The radii covered by the detector range from 16~mm to 60~mm from the IP.

\begin{figure}[h!]
\centering
\includegraphics[width=0.3\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Vertex3.png}
\caption[Vertex detector design for ILD.  Figures taken from \cite{arXiv:1006.3396}.]{Vertex detector design for ILD.  Figures taken from \cite{arXiv:1006.3396}.}
\label{fig:vertexpicture}
\end{figure} 

%========================================================================================

\subsection{Time Projection Chamber}
The central tracking system for the ILD detector is a TPC, which is shown in figure \ref{fig:tracker}.  The TPC consists of a cylindrical gas volume with a central electrode providing an axial electric field.  When a charged particle passes through the TPC, it ionises the gas and the ionised molecules drift in the axial electric field.  The direction of the electric field is chosen such that the electrons drift towards the endplates where they are collected.  The position of the ionisation point can then be calculated using the drift time of the electrons in the TPC.  Combining these TPC hits together makes reconstruction of the full charged particle track possible.  TPCs have an advantage over silicon tracking in that they continuously track any charged particle passing through them, while silicon detectors are only sensitive within each silicon layer.  This compensates for the worse single point resolution that TPCs have in comparison to silicon detectors and makes TPCs a viable option for the ILD detector.  Furthermore, TPCs have a very low material budget.  This benefits calorimetry as it minimises energy losses prior to the particle energy entering the calorimeters, which means the calorimetric energy deposits give a better reflection of the true particle energy.  

The ILD TPC has a point resolution of better than 100~{\mu}m and a double hit resolution in $\phi$ of less than 2~mm.  The gas used for the TPC will be Ar:$\text{CH}_4$:$CO_{2}$ (95:3:2) \cite{Abe:2010aa}.  Several readout technology options, designed to measure the ionisation current, are currently under development.  For all potential options it is envisaged that the readout pads would be $\approx 1 \times 6 \text{mm}^{2}$ giving a total of approximately $10^{6}$ pads on each TPC endplate.

\begin{figure}[h!]
\centering
\subfloat[]{\label{fig:tracker1}\includegraphics[width=0.5\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Tracker1.png}}
\subfloat[]{\label{fig:tracker2}\includegraphics[width=0.5\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Tracker2.png}}
\caption[\protect\subref{fig:tracker1} Drawing of the proposed end-plate for the TPC.  In the insert a back frame, which is designed to support the readout modules, is shown.  \protect\subref{fig:tracker2} Conceptual sketch of the TPC system showing the main parts of the TPC (not to scale).  The central electrode generates the axial electric field, the endplates collect the ionisation electrons, the field strips help to maintain a uniform electric field across the TPC and the voltage divider strips maintains the voltage difference between the anode and cathode.  The field strips are held at fixed voltages such that they replicate the electric filed produced by the electrodes.  This reinforcing of the electric field configuration minimises non-uniformities in the electric field.  The field cage of the TPC is not shown.]{\protect\subref{fig:tracker1} Drawing of the proposed end-plate for the TPC.  In the insert a back frame, which is designed to support the readout modules, is shown.  \protect\subref{fig:tracker2} Conceptual sketch of the TPC system showing the main parts of the TPC (not to scale).  The central electrode generates the axial electric field, the endplates collect the ionisation electrons, the field strips help to maintain a uniform electric field across the TPC and the voltage divider strips maintains the voltage difference between the anode and cathode.  The field strips are held at fixed voltages such that they replicate the electric filed produced by the electrodes.  This reinforcing of the electric field configuration minimises non-uniformities in the electric field.  The field cage of the TPC is not shown.}
\label{fig:tracker}
\end{figure} 

%========================================================================================

\subsection{Supplemental Silicon Tracking System}
There are four components that make up the supplemental silicon tracking system in ILD, shown in figure \ref{fig:vertex}, which are:
\begin{itemize}
\item Silicon Inner Tracker (SIT) and Silicon External Tracker (SET).  These are both barrel components, which are positioned immediately inside and outside the TPC.  The SIT helps form associations between hits in the vertex detector and TPC, while the SET helps with extrapolation of TPC tracks into the calorimeter.  
\item Endplate of the TPC (ETD).  This sensor is identical to the SET, but is positioned in front of the ECal endcap calorimeter.  The ETD extends the coverage of the supplemental silicon tracking system envelope. 
\item Forward tracker (FTD).  This detector consists of seven silicon disks that extend the coverage of the tracking down to small angles that are not covered by the TPC.  
\end{itemize}

\begin{figure}[h!]
\centering
\subfloat[]{\label{fig:vertex1}\includegraphics[width=0.5\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Vertex1.jpg}}
\subfloat[]{\label{fig:vertex2}\includegraphics[width=0.5\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Vertex2.pdf}}
\caption[\protect\subref{fig:vertex1} A 3D detailed GEANT4 simulation description of the silicon system.  \protect\subref{fig:vertex2} A quadrant view of the ILD silicon envelope made of the four components SIT, SET, ETD and FTD as included in the full MOKKA simulation.  Figures taken from  \cite{Behnke:2013lya}.]{\protect\subref{fig:vertex1} A 3D detailed GEANT4 simulation description of the silicon system.  \protect\subref{fig:vertex2} A quadrant view of the ILD silicon envelope made of the four components SIT, SET, ETD and FTD as included in the full MOKKA simulation.  Figures taken from  \cite{Behnke:2013lya}.}
\label{fig:vertex}
\end{figure} 

\begin{table}[h!]
\centering
\begin{tabular}{ l r}
\hline
Tracking System & Coverage [cos$\theta$] \\
\hline
SIT & 0.910 \\
SET & 0.789 \\
ETD & 0.799 - 0.985 \\
FTD & 0.802 - 0.996\\
\hline
\end{tabular}
\caption[Coverage of the supplementary silicon tracking systems in the ILD detector.  In this table $\theta$ is the polar angle with respect to the beam direction.  Taken from \cite{Behnke:2013lya}.]{Coverage of the supplementary silicon tracking systems in the ILD detector.  In this table $\theta$ is the polar angle with respect to the beam direction.  Taken from \cite{Behnke:2013lya}.}
 \label{table:supptrackingcoverage}
\end{table}

The coverage of the SIT, SET, ETD and FTD is given in table \ref{table:supptrackingcoverage}.  These detectors are designed to give high precision space points that can be used in track fitting.  Furthermore, the ETD and SET are of particular use for extrapolating the charged particle tracks into the calorimeters.  This is key for particle flow calorimetry, which relies upon correct association of charged particle tracks and clusters of calorimeter hits.  Analogously to the vertex detector, these detectors require low material budget and low occupancy.  The FTD, due to its proximity to the beam axis, is particularly prone to high occupancies.  

The SIT, SET and ETD are silicon pixel sensors with 50~{\mu}m pitch embedded in 200~{\mu}m thick silicon.  The FTD consists of seven silicon tracking disks, the first two being pixel detectors and the remaining five being strip detectors.  The pixel detector disks are formed of 16 petals, as shown in figure \ref{fig:ftd}.  Within these petals the pixel size varies from $26 \times 29~{\mu}m^{2}$ to $26 \times 67~{\mu}m^{2}$.  Strip detectors are used for the outermost tracking disks as the occupancy considerations do not demand a high granularity detector i.e. a pixel detector.  These detector disks will have a pitch of 50~{\mu}m.  The active sensor and readout ASIC design for each of these detectors is an active area of development for the linear collider.  

\begin{figure}[h!]
\centering
\includegraphics[width=0.8\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/FTD.png}
\caption[A half-disk for the FTD showing the petal concept.  The rightmost zoom image showers a detail of the end-of-petal area that houses the read-out electronics.  The leftmost image shows the region at $R = 8$~cm where both the column width and the $R$-dimension of the pixels changes.  Figures taken from \cite{Behnke:2013lya}.]{A half-disk for the FTD showing the petal concept.  The rightmost zoom image showers a detail of the end-of-petal area that houses the read-out electronics.  The leftmost image shows the region at $R = 8$~cm where both the column width and the $R$-dimension of the pixels changes.  Figures taken from \cite{Behnke:2013lya}.}
\label{fig:ftd}
\end{figure} 

%========================================================================================

\subsection{Electromagnetic Calorimeter}
\label{sec:ildecal}
The nominal ILD detector contains a finely segmented electromagnetic sampling calorimeter (ECal).  The ECal surrounds the tracking system in the ILD detector.  It has been specifically designed with particle flow calorimetry in mind.  To that extent the spatial resolution of particle showers within the ECal takes as much, if not more, precedence than the energy resolution.  The primary goal of the ECal is to induce electromagnetic particles to shower within it and to record the energy deposited by those showers.  

There are a number of design requirements for the ECal:
\begin{itemize}
\item The ECal must be compact in size to reduce the overall cost of the detector.
\item Fine segmentation of the ECal is required so that nearby particle showers can be separated.  This is an essential requirement for particle flow calorimetry.
\item Electromagnetic showers should be contained within the ECal.
\end{itemize}
Based on these requirements tungsten is used as the absorber material for the ILD ECal as it has a small radiation length ($X_{0}$), a small Moliére radius and a large ratio of radiation length to nuclear interaction length.  A comparison of these properties for other ECal absorber material candidates is shown in table \ref{table:absorberoptions}.  The small radiation length in tungsten allows for a large number of radiation lengths, $\approx 24 X_{0}$, to be compacted within a relatively short distance, $\approx 20$ cm, in nominal ILD ECal.  This is sufficient for containing all but the highest energy electromagnetic showers.  The small Moliére radius in tungsten will lead to compact electromagnetic showers.  This makes separation of nearby showers easier.  Finally, the large ratio of the radiation length to the nuclear interaction length in tungsten will lead to greater longitudinal separation between electromagnetic and hadronic showers again making shower identification easier.   

The active material in the nominal ILD ECal is silicon, however, a scintillator strip option is also being considered.  It contains a total of 30 readout layers, which is sufficient to provide a good energy resolution.  The tungsten thickness for the innermost 20 layers is 2.1~mm, while for the final 10 layers it is 4.2~mm.  This configuration of absorber material thickness is chosen to reduce the number of readout channels and hence the cost, while maintaining a high sampling rate for particle showers at the start of the ECal.  It should be noted that this ECal offers no gains in terms of energy resolutions in comparison to preexisting particle collider experiments, as shown in table \ref{table:ecalenergyres}.  This is the case as the focus of this calorimeter is split between imaging the particle showers and recording their energy as opposed to purely focusing on the energy measurement.  Each of the ECal layers is divided up into square cells, of side length 5~mm, which makes separation of nearby particle showers possible.  This cell size was chosen as a balance between being able to resolve nearby particle showers and reducing the overall cost of the calorimeter, which scales with the number of readout channels.  An optimisation study of the various ECal parameters for the ILD detector can be found in section \ref{sec:ecal}.

\begin{table}[h!]
\centering
\begin{tabular}{ l l l l l}
\hline
Material & $\lambda_{I}$ (cm) & $X_{0}$ (cm) & $\rho_{M}$ (cm) & $ \frac{\lambda_{I}}{X_{0}}$ \\
\hline
Fe & 16.8 & 1.76 & 1.69 & 9.5 \\
Cu & 15.1 & 1.43 & 1.52 & 10.6 \\
W & 9.6 & 0.35 & 0.93 & 27.4 \\
Pb & 17.1 & 0.56 & 1.00 & 30.5 \\
\hline
\end{tabular}
\caption[Comparison of the nuclear interaction length $\lambda_{I}$, radiation length $X_{0}$ and Moliére radius for iron, copper, tungsten and lead.  Table taken from \cite{arXiv:0907.3577}.]{Comparison of the nuclear interaction length $\lambda_{I}$, radiation length $X_{0}$ and Moliére radius for iron, copper, tungsten and lead.  Table taken from \cite{arXiv:0907.3577}.}
\label{table:absorberoptions}
\end{table}

\begin{table}[h!]
\centering
\begin{tabular}{ l l }
\hline
Experiment & ECal Energy Resolution $\frac{\sigma_{E}}{E}$ \\
\hline
CMS \cite{Chatrchyan:2013dga} & $\sim \frac{2.8\%}{\sqrt{E(\text{GeV})}} \oplus 0.3\% \oplus \frac{12\%}{E(\text{GeV})}$ \\
ATLAS \cite{Aharrouche:2006nf} & $\sim \frac{10.1\%}{\sqrt{E(\text{GeV})}} \oplus 0.1\%$ \\
LHCb \cite{Perret:2014owa} & $\sim \frac{9\%}{\sqrt{E(\text{GeV})}} \oplus 0.8\%$ \\
ILC (ILD Silicon Option) \cite{Behnke:2013lya} & $\sim \frac{16.6\%}{\sqrt{E(\text{GeV})}} \oplus 1.1\%$ \\
\hline
\end{tabular}
\caption[Comparison of the ECal energy resolutions for various experiments.]{Comparison of the ECal energy resolutions for various experiments.}
\label{table:ecalenergyres}
\end{table}

\begin{figure}[h!]
\centering
\subfloat[]{\label{fig:ecal1}\includegraphics[width=0.4\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/SiECal.png}} 
\hspace{1cm}
\subfloat[]{\label{fig:ecal2}\includegraphics[width=0.4\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/ScECal.png}}
\caption[Cross section through ECal layer for \protect\subref{fig:ecal1} silicon and \protect\subref{fig:ecal2} scintillator option.  Figures taken from  \cite{Behnke:2013lya}.]{Cross section through ECal layer for \protect\subref{fig:ecal1} silicon and \protect\subref{fig:ecal2} scintillator option.  Figures taken from  \cite{Behnke:2013lya}.}
\label{fig:ecal}
\end{figure} 

%========================================================================================

\subsection{Hadronic Calorimeter}
A finely segmented hadronic sampling calorimeter (HCal) is also present in the nominal ILD HCal.  This calorimeter surrounds the ECal and, analogously to the ECal, has been designed with particle flow calorimetry in mind.  The primary goal of the HCal is to induce hadronic showers within it and record the energy deposited by those showers.  

The design requirements for the HCal mirror those of the ECal, which can be found in section \ref{sec:ildecal}, with one exception; the HCal is designed to contain hadronic showers as opposed to electromagnetic showers.  Steel is used as the absorber material for the HCal as it has durable mechanical properties that allow the HCal to be constructed without the need of auxiliary supports.  If required, auxiliary supports would create dead regions in the detector that would harm performance.  Furthermore, steel is relatively inexpensive and has a relatively small nuclear interaction length, meaning it is possible to achieve a compact calorimeter design at low cost.  The nominal ILD HCal contains approximately $6 \lambda_{I}$, which when combined with the $1 \lambda_{I}$ in the ECal is enough to contain the majority of hadronic showers at ILC like energies.  

The active material in the nominal ILD HCal is scintillator.  In total, the HCal contains 48 readout layers, which provides an extremely good energy resolution.  This can be seen when comparing the HCal energy resolution between different experiments, as shown in table \ref{table:hcalenergyres}.  An individual layer in the HCal is comprised of 20~mm of steel absorber material with 3~mm of scintillator active material.  Each layer in the HCal is segmented into square cells, of side length 30~mm.  This cell size was chosen as a balance between reducing the cost of the detector, which is proportional to the number of readout channels, and achieving the required spatial resolution to make particle flow calorimetry possible.  The segmentation of the ILD HCal gives excellent spatial resolution and sufficiently good energy resolution to make the use of particle flow calorimetry a reality.  An optimisation study of the various HCal parameters for the ILD detector can be found in section \ref{sec:hcal}.

The ILD HCal is intrinsically non-compensating, which means that it has a different response to electromagnetic and hadronic showers.  The origin of this different response is the fundamentally different mechanisms governing the propagation of electromagnetic and hadronic showers.  One key difference between the mechanisms is that hadronic showers have an invisible energy component, which occurs due to  effects such as neutrons coming to rest in the detector and nuclear biding energy losses \cite{Tran:2017tgr}.  In general, this leads to a lower response from a calorimeter to a hadronic shower than an electromagnetic shower.  A number of different software techniques have been developed for the linear collider experiment that attempt to correct this non-compensating response.  For more details see chapter \ref{chap:energyestimators}.  The ILD ECal has a compensating response due to the use of tungsten as the absorber material \cite{Blaising:2015nla}, therefore, no additional treatment of energies is required.

\begin{table}[h!]
\centering
\begin{tabular}{ l l }
\hline
Experiment & HCal Energy Resolution $\frac{\sigma_{E}}{E}$ \\
\hline
CMS \cite{Budd:2001eu} & $\sim \frac{90\%}{\sqrt{E(\text{GeV})}} \oplus 4.8\%$ \\
ATLAS \cite{Airapetian:1996iv} & $\sim \frac{52.1\%}{\sqrt{E(\text{GeV})}} \oplus 3.0\% \oplus \frac{1.6\%}{E(\text{GeV})}$ \\
LHCb \cite{Perret:2014owa} & $\sim \frac{69\%}{\sqrt{E(\text{GeV})}} \oplus 9.0\%$ \\
ILC (ILD Silicon Option) \cite{Behnke:2013lya} & $\sim \frac{43.3\%}{\sqrt{E(\text{GeV})}} \oplus 1.8\%$ \\
\hline
\end{tabular}
\caption[Comparison of the HCal energy resolutions for various experiments.]{Comparison of the HCal energy resolutions for various experiments.}
\label{table:hcalenergyres}
\end{table}

%========================================================================================

\subsection{Solenoid, Yoke and Muon System}
Surrounding the HCal in ILD is a solenoid, which generates a 3.5~T magnetic field.  The magnetic field produced by the coil is crucial for bending charged particles so that their momentum can be determined from the curvature of the path they transverse.  Furthermore, the bending of charged particles leads to greater separation of calorimetric energy deposits between charged and neutral particles, which will reduce the effects of confusion when using particle flow calorimetry.  

The magnetic field in the ILD detector is returned by an iron yoke that surrounds the solenoid.  Iron is chosen for the yoke material as it has a very large permeability.  

This yoke is instrumented by a muon system in the barrel and forward regions of the detector.  The goal of this instrumentation is to identify muons escaping the calorimeters and to act as a tail catcher for the calorimeters.  The muon system consists of 10 layers, spaced 140~mm apart, followed by 2 (3) layers spaced 600~mm apart in the barrel (endcap) region of the detector, as shown in figure \ref{fig:muon}.  There is also an additional sensitive layer for the barrel region placed immediately outside the HCal to help with association energy deposits between the calorimeters and the yoke.  As the majority of particles at ILC like energies will be contained within the calorimeters, the energy and spatial resolution of the muon system are not critical to performance.  It is for that reason that the number of layers is lower and the layer thicknesses wider in the yoke than in the calorimeters.  The nominal ILD model uses 30~mm wide and 1 m long scintillator strips as the readout technology for the yoke.

\begin{figure}[h!]
\centering
\includegraphics[width=0.5\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Muon.png}
\caption[The sensitive layers of the ILD muon system.  Figure taken from  \cite{Behnke:2013lya}.]{The sensitive layers of the ILD muon system.  Figure taken from  \cite{Behnke:2013lya}.}
\label{fig:muon}
\end{figure}   

%========================================================================================

\subsection{Forward Calorimetry}
Forward calorimetry in the ILD detector consists of three additional sampling calorimeters:
\begin{itemize}
\item The LumiCal, which is located within the octagonal hole in the ECal endcap.  This will give a precise measurement of the luminosity of the linear collider beam.   The LumiCal uses Bhabha scattering, $\text{e}^{+}\text{e}^{-} \rightarrow \text{e}^{+}\text{e}^{-}(\gamma)$, as a gauge process for the luminosity measurement.  Using this approach the luminosity can be measured with precision of less than $10^{-3}$ at 500 GeV \cite{Abe:2010aa}. 
\item The LHCal, which is positioned within the square hole of the HCal endcap.  This hadronic calorimeter is designed to extend the coverage of the HCal down to small polar angles.  
\item The BeamCal, which is located just in front of the final focusing quadrupole.  This calorimeter will perform a bunch-by-bunch estimate of the luminosity based on the energy deposited in the calorimeter.
\end{itemize}
The layout of these calorimeters is shown in figure \ref{fig:fcal} and their coverage is summarised in table \ref{table:fcalcoverage}.  Each of the forward calorimeters will have to deal with high occupancies due to the presence of background processes, e.g. beamstrahlung, which makes fast readout crucial.  Furthermore, the BeamCal experiences a large flux of low energy electrons due to its proximity to the beam pipe, which results in a large radiation dose.  This makes radiation hard sensors essential for the BeamCal.  

\begin{figure}[h!]
\centering
\includegraphics[width=0.5\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/FCal.png}
\caption[The very forward region of the ILD detector.  LumiCal, BeamCal and LHCal are carried by the support tube for the final focusing quadruple, QD0, and the beam pipe.  Figure taken from  \cite{Behnke:2013lya}.]{The very forward region of the ILD detector.  LumiCal, BeamCal and LHCal are carried by the support tube for the final focusing quadruple, QD0, and the beam pipe.  Figure taken from  \cite{Behnke:2013lya}.}
\label{fig:fcal}
\end{figure} 

\begin{table}[h!]
\centering
\begin{tabular}{ l r }
\hline
Forward Calorimeter & Polar Angle Coverage [mrad] \\
\hline
LumiCal & 31 - 77 \\
LHCal & $\sim$ 29-122 \\
BeamCal & 5 - 40 \\
\hline
\end{tabular}
\caption[Coverage of the forward calorimeters in the ILD detector.]{Coverage of the forward calorimeters in the ILD detector.}
\label{table:fcalcoverage}
\end{table}

Each of these calorimeter is constructed using tungsten as the absorber material.  The small Moliére radius of tungsten ensures that narrow electromagnetic showers are formed within them, which makes separation and identification of showering particles easier.  

The layout of these calorimeters is as follows:
\begin{itemize}
\item The LumiCal is a silicon tungsten sampling calorimeter that contains 30 readout layers.  This gives the LumiCal a total depth of $\approx 24 X_{0}$.  
\item The LHCal is also a silicon tungsten sampling calorimeter, which contains 40 readout layers.  The total depth of the LHCal is $\approx 4 \lambda_{I}$.
\item The BeamCal is a tungsten based sampling calorimeter.  The sensitive detector material for the BeamCal is an ongoing area of research as, due to the extremely high occupancy from the beam induced backgrounds, a very fast readout is required.  The exact layer configuration of the BeamCal will depend upon the choice of sensitive detector material and hence is yet to be specified.  
\end{itemize}
The segmentation within the layers, the cell size, in these forward calorimeter is yet to be fully optimised.

%========================================================================================

\section{Simulation}
Detector model simulation for all studies presented in this work was performed using MOKKA \cite{MoradeFreitas:2002kj}, a GEANT4 \cite{Agostinelli:2002hh} wrapper providing detailed geometric descriptions of detector concepts for the linear collider.  

For the ILD detector model in Mokka:
\begin{itemize}
\item The vertex detector is simulated using silicon as the sensitive material.  Support material and the cryostat are also included for additional realism.
\item The supplementary silicon tracking systems are included.  Again, material has been added to the simulation to represent the support material for these systems.  Furthermore, an estimation has been made of the material budget for power and readout cables from the vertex detector, SIT and FTD and material has been added to the simulation to represent these.  The material added to represent the power and readout cables comes in the form of an aluminium cylinder running inside the TPC field cage and around a cone around the beam pipe.
\item The TPC is simulated as a cylindrical volume of a gas mixture surrounded by a field cage.  A conservative estimate of the endplate is included in the simulation to account for the support structure, electronics and cooling pipes for the TPC.
\item As well as including the silicon tungsten sampling calorimeter, the simulation of the ILD ECal contains additional material to represent the instrumented region of the sensor and a heat shield as shown in figure \ref{fig:ecal}.
\item Simulation of the ILD HCal has a number of realistic features including detailed modelling of the electronics, detector gaps and the implementation of Birk's law for the scintillator sensitive detector elements.
\item The muon system, which is the instrumentation of the iron yoke, uses scintillator as the active material in the simulation.  A square cell size of side length 30~mm is assumed.  This is in contrast to the nominal ILD model, but as the tail-catcher plays a minimal role in event reconstruction at ILC like energies this difference should have negligible impact.  
\item The forward calorimeters, the LumiCal, LHCal and BeamCal, are all included in the simulation.  Tungsten is used as the absorber material for each of the calorimeters.  The LumiCal and LHCal use a silicon readout material, while the BeamCal uses a diamond readout.  
\end{itemize}

%========================================================================================

%\section{Reconstruction Chain}

%\section{Event Generation, Simulation and Reconstruction}

%The jet fragmentation and hadronisation for the Z $\rightarrow$ uds events used for determining the metric for detector performance was controlled using PYTHIA \cite{Sjostrand:2006za} that had been tuned using data from LEP \cite{Alexander:1995bk}.  Single particle spatially isotropic samples of $K_{L}^{0}$, $\gamma$ and $\mu^{-}$ were produced for the calibration of each detector model.  A simple c++ script was written to generate the relevant HEPEvt common blocks for these samples. 

%Event reconstruction was performed using MARLIN \cite{Gaede:2006pj}, a c++ framework designed for reconstruction at the linear collider.  PandoraPFA \cite{arXiv:0907.3577, arXiv:1209.4039} was used to apply Particle Flow Calorimetry in the reconstruction, the full details of which can be found in chapter PANDORA CHAPTER.

%========================================================================================

\section{CLIC ILD}
The increased collision energy of the proposed CLIC accelerator means the use of the nominal ILD detector model would be inappropriate.  Therefore, a new detector model, CLIC\_ILD \cite{Linssen:2012hp}, based upon the nominal ILD detector model was created to cope with the experimental conditions found at the CLIC experiment.  The main differences between the nominal ILD detector and CLIC\_ILD are:

\begin{figure}[h!]
\centering
\subfloat[]{\label{fig:clicild1}\includegraphics[width=0.4\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/CLIC_ILD.png}}
\hspace{1cm}
\subfloat[]{\label{fig:clicild2}\includegraphics[width=0.4\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/CLIC_ILD_2.png}}
\caption[\protect\subref{fig:ild1} Longitudinal (top quadrant) and \protect\subref{fig:ild2} transverse cross section of the CLIC\_ILD detector.  Figures taken from \cite{Linssen:2012hp}.]{\protect\subref{fig:ild1} Longitudinal (top quadrant) and \protect\subref{fig:ild2} transverse cross section of the CLIC\_ILD detector.  Figures taken from \cite{Linssen:2012hp}.}
\label{fig:clicild}
\end{figure} 

\begin{itemize}
\item The higher energies found at the CLIC experiment lead to more intense beam induced backgrounds, which is especially problematic for detectors close to the IP where the occupancies will be extremely high.  For this reason the inner vertex detector in CLIC\_ILD is moved 15~mm further out from the IP.    
\item The HCal thickness is increased from 6 $\lambda_{I}$ to 7.5 $\lambda_{I}$.  This ensures that higher energy hadronic showers found at the CLIC experiment are contained within the calorimeters.  
\item The HCal absorber material for the barrel is tungsten as opposed to steel.  This reduces the overall thickness of the HCal and keeps the coil size, one of the driving cost factors for the detectors, similar for the nominal ILD and CLIC\_ILD detectors.  Steel is used as the absorber material for the HCal endcaps as there are no spatial requirements relating to the coil size and this will lower the detector cost.  Furthermore, the shower development time in steel is faster than in tungsten making effective time stamping of energy deposits easier, which is crucial for the CLIC experiment for vetoing beam induced backgrounds.  
\item The magnetic field strength in the CLIC\_ILD detector is increased to 4 T.  This was found to benefit the reconstruction, particularly at high energies, as it leads to greater separation of charged particle tracks.  Furthermore, it was possible to achieve this increase in field strength using the nominal ILD coil design.   
\item The CLIC\_ILD detector contains masking, graphite layers placed in front of the BeamCal, to prevent particles produced by the beam-induced interactions from backscattering into the main detector.  It is the increased collision energy that makes backscattering of particles a more problematic effect for the CLIC experiment than it is for the ILC experiment.   
\end{itemize}  

%========================================================================================
%======================================================================================== 

\section{Particle Flow Reconstruction}
Particle flow calorimetry relies upon correct associations being made between calorimetric energy deposits and charged particle tracks.  Even with a finely segmented detector, such as the ILD detector described in section \ref{sec:ild}, correctly making these associations is a highly a non-trivial task and must be done using advanced pattern recognition software.  This is provided by the PandoraPFA particle flow algorithm \cite{arXiv:0907.3577, arXiv:1209.4039}.

%======================================================================================== 

\subsection{PandoraPFA}
PandoraPFA takes as input calorimeter hits and charged particles tracks and produces as output reconstructed particles known as particle flow objects (PFOs).  The pattern recognition in PandoraPFA is applied in eight main stages \cite{arXiv:0907.3577}:
\begin{enumerate}
\item Track selection.  The input track collections are examined to determine whether $V^{0}$ decays, two charged tracks originating from a point displaced from the IP, or kinks, where a charged particle has decayed into a single charged particle and a number of neutral ones, are present.  Such information will be propagated in the reconstruction to the final PFO creation stage.  
\item Calorimeter hit treatment.  The treatment of calorimeter hits by PandoraPFA is of paramount importance to the work presented in chapters \ref{chap:energyestimators} and \ref{chap:detopt}.  Therefore, full details of the calorimeter hit selection procedure are presented here.  This selection procedure is broken down into several steps:
\begin{itemize}
\item The various collection of, post digitisation, calorimeter hits are passed into the Pandora framework and converted into Pandora calorimeter hits.  
\item To minimise any dependancy on the detector geometry each calorimeter hit is assigned to a pseudo-layer, which is representative of the hits position in the calorimeter.  All further topological association algorithms work using the pseudo-layer definition, illustrated in figure \ref{fig:pseudolayer}.  
\item A minimum ionising particle equivalent energy cut is applied to the calorimeter hits.  If a calorimeter hit contains less than 0.5 (0.3) of the energy of a normally incident MIP passing through the calorimeter cell in the ECal (HCal) then it is not used in the reconstruction.  
\item If a calorimeter hit is sufficiently far away from other hits, it is flagged as an isolated hit.  Such hits are most likely due to low energy neutrons produced in hadronic showers, which can travel a significant distance from the original shower before depositing energy.  Due to the distance they travel these hits are very difficult to associate to the correct particle shower.  Furthermore, as such hits are unlikely to be the seed for a particle shower they are not used by the initial clustering algorithm.  
\item Any calorimeter hit that contains an energy consistent with a MIP signal and where, at most, one Pandora calorimeter hit exists in the neighbouring cells within the same layer is flagged as a MIP consistent hit.  This information is used in the identification of MIPs in the reconstruction.
\item The energy contribution for each calorimeter hits ultimately depends on whether the cluster the calorimeter hit has been associated to is deemed to have originated from an electromagnetic or hadronic particle shower.  Different scale factors are applied to the energy for electromagnetic and hadronic showers to account for the non-compensating response of the calorimeters.  These scale factors are used throughout the reconstruction, including the final reconstructed particle energy, once the particle shower type has been identified.  For energy comparisons prior to the shower type being identified the uncorrected calorimeter hit energy is used.  Further details on how these calibration constants are determined can be found in chapter \ref{chap:energyestimators}.  
\end{itemize}
\item Clustering.  This begins by using the projection of the charged particle tracks onto the front face of the ECal as seeds for the initial clustering phase.  Calorimeter hits are looped over on a per layer basis, working from the inner to the outer pseudo-layer, and if they fall within a cone of fixed dimensions surrounding a cluster direction they are associated to the cluster.  If no association can be made to any preexisting calorimeter hit clusters then the calorimeter hit is used to seed a new cluster.  
\item Topological cluster merging.  The initial clustering algorithm is designed to be conservative to avoid mixing together energy deposits from several particles.  The fragments produced by the initial clustering are then merged together by various algorithms whose logic is motivated by a number of well-motivated topological rules, such as those shown figure \ref{fig:associations}.  
\item Statistical re-clustering.  Comparisons between the cluster energy and any associated track momenta are made to determine whether they are consistent.  If a large discrepancy is observed then statistical re-clustering is initiated.  This involves running a number of differently configured algorithms to change the cluster configuration to determine if a new optimal configuration of tracks and clusters can be found.  

This step relies upon the reported cluster energies being accurate.  To ensure this is the case, a well defined calibration procedure is applied for all detector models considered in this work, for more details see chapter \ref{chap:energyestimators}.  At this point in the reconstruction, the energy resolution of the calorimeters impacts the way that the pattern recognition is performed.  The better the energy resolution of the calorimeters, the fewer the number of mistakes that are made when pairing up clusters of calorimeter hits to charged particle tracks.    

\item Photon identification and recovery.  Topological likelihood data is used to identify clusters of calorimeter hits that are consistent with $\gamma$s.  This is possible due to the clear transverse and longitudinal profiles observed for electromagnetic showers.  
\item Fragment removal.  Neutral clusters originating from a nearby charged particle cluster are identified and merged back into the parent charged particle cluster.  These algorithms take into account the changes in the compatibility of the track and cluster associations when merging any neutral clusters into charged clusters.  
\item Formation of particle flow objects.  Finally, reconstructed particles are produced.  The energy for charged particles is taken from the track momenta, while neutral particle energies are taken from the calorimeter cluster measurements.  Furthermore, the different electromagnetic and hadronic scales are applied to the output neutral particle energies depending on whether the neutral cluster is consistent with a $\gamma$.  
\end{enumerate}

\begin{figure}[h!]
\centering
\subfloat[]{\label{fig:pseudolayer1}\includegraphics[width=0.4\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/PseudoLayer1.png}}
\hspace{1cm}
\subfloat[]{\label{fig:pseudolayer2}\includegraphics[width=0.4\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/PseudoLayer2.png}}
\caption[Schematic showing the definition of the pseudo-layer assignment for calorimeter hits.  The solid lines indicate the positions of the physics ECal layers and the dashed lines show the definition of the virtual pseudo-layers.  \protect\subref{fig:pseudolayer1} The $xy$-view showing the ILD ECal stave structure.  \protect\subref{fig:pseudolayer2} The $xz$ view showing a possible layout for the ECal barrel/endcap overlap region.  The pseudo-layers are defined using projection back to the IP.  Figures taken from \cite{arXiv:0907.3577}.]{Schematic showing the definition of the pseudo-layer assignment for calorimeter hits.  The solid lines indicate the positions of the physics ECal layers and the dashed lines show the definition of the virtual pseudo-layers.  \protect\subref{fig:pseudolayer1} The $xy$-view showing the ILD ECal stave structure.  \protect\subref{fig:pseudolayer2} The $xz$ view showing a possible layout for the ECal barrel/endcap overlap region.  The pseudo-layers are defined using projection back to the IP.  Figures taken from \cite{arXiv:0907.3577}.}
\label{fig:pseudolayer}
\end{figure} 

\begin{figure}[h!]
\centering
\subfloat[]{\label{fig:association1}\includegraphics[width=0.2\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Association1.png}}
\hspace{5mm}
\subfloat[]{\label{fig:association2}\includegraphics[width=0.2\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Association2.png}}
\hspace{5mm}
\subfloat[]{\label{fig:association3}\includegraphics[width=0.2\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Association3.png}}
\hspace{5mm}
\subfloat[]{\label{fig:association4}\includegraphics[width=0.2\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Association4.png}} \\
\subfloat[]{\label{fig:association5}\includegraphics[width=0.2\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Association5.png}}
\hspace{5mm}
\subfloat[]{\label{fig:association6}\includegraphics[width=0.2\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Association6.png}}
\hspace{5mm}
\subfloat[]{\label{fig:association7}\includegraphics[width=0.2\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Association7.png}}
\hspace{5mm}
\subfloat[]{\label{fig:association8}\includegraphics[width=0.2\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Association8.png}}
\hspace{5mm}
\subfloat[]{\label{fig:association9}\includegraphics[width=0.2\textwidth]{LCDetectorsAndPFlow/Plots/Pictures/Association9.png}}
\caption[The main topological rules for cluster merging: \protect\subref{fig:association1} looping track segments; \protect\subref{fig:association2} track segments with gaps; \protect\subref{fig:association3} track segments pointing to hadronic showers; \protect\subref{fig:association4} track-like neutral clusters pointing back to a hadronic shower; \protect\subref{fig:association5} back-scattered tracks from hadronic showers; \protect\subref{fig:association6} neutral clusters which are close to a charged cluster; \protect\subref{fig:association7} a neutral cluster near a charged cluster; \protect\subref{fig:association8} cone association; and \protect\subref{fig:association9} recover of photons which overlap with a track segment.  In each case the arrow indicates the track, the filled points represent the hits in the associated cluster and the open points represent hits in the neutral cluster.  Figures taken from \cite{arXiv:0907.3577}.]{The main topological rules for cluster merging: \protect\subref{fig:association1} looping track segments; \protect\subref{fig:association2} track segments with gaps; \protect\subref{fig:association3} track segments pointing to hadronic showers; \protect\subref{fig:association4} track-like neutral clusters pointing back to a hadronic shower; \protect\subref{fig:association5} back-scattered tracks from hadronic showers; \protect\subref{fig:association6} neutral clusters which are close to a charged cluster; \protect\subref{fig:association7} a neutral cluster near a charged cluster; \protect\subref{fig:association8} cone association; and \protect\subref{fig:association9} recover of photons which overlap with a track segment.  In each case the arrow indicates the track, the filled points represent the hits in the associated cluster and the open points represent hits in the neutral cluster.  Figures taken from \cite{arXiv:0907.3577}.}
\label{fig:associations}
\end{figure} 

The application of the pattern recognition algorithms in PandoraPFA when combined with a highly segmented detector make particle flow calorimetry a reality.  In turn this provides excellent jet energy resolution for studying many interesting physics processes at the linear collider experiment.

%======================================================================================== 

\subsection{Performance}



